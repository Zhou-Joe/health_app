<view class="symptom-logs-container app-theme">
  <view class="header-section">
    <text class="header-title">ç—‡çŠ¶æ—¥å¿—</text>
    <text class="header-desc">è®°å½•æ‚¨çš„ç—‡çŠ¶å˜åŒ–ï¼Œä¾¿äºå¥åº·è¿½è¸ª</text>
  </view>

  <view class="logs-list" wx:if="{{logs.length > 0}}">
    <view class="log-item" wx:for="{{logs}}" wx:key="id">
      <view class="log-date">{{item.entry_date}}</view>
      <view class="log-content">
        <view class="log-main">
          <text class="symptom-name">{{item.symptom}}</text>
          <view class="severity-badge" style="background: {{item.severityColor}}20; color: {{item.severityColor}}">
            <text>{{item.severity_display || item.severity}}çº§ - {{item.severity >= 4 ? 'ä¸¥é‡' : item.severity >= 3 ? 'ä¸­åº¦' : 'è½»å¾®'}}</text>
          </view>
        </view>
        <view class="log-notes" wx:if="{{item.notes}}">
          <text>{{item.notes}}</text>
        </view>
        <view class="log-actions">
          <text class="action-btn edit" bindtap="editLog" data-log="{{item}}">ç¼–è¾‘</text>
          <text class="action-btn delete" bindtap="deleteLog" data-log="{{item}}">åˆ é™¤</text>
        </view>
      </view>
    </view>
  </view>

  <view class="empty-state" wx:elif="{{!loading}}">
    <text class="empty-icon">ğŸ“</text>
    <text class="empty-text">æš‚æ— ç—‡çŠ¶è®°å½•</text>
    <text class="empty-desc">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ æ‚¨çš„ç¬¬ä¸€æ¡ç—‡çŠ¶è®°å½•</text>
  </view>

  <view class="loading-state" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <button class="add-btn" bindtap="showAddModal">
    <text class="add-icon">â•</text>
    <text>æ·»åŠ ç—‡çŠ¶è®°å½•</text>
  </button>

  <view class="modal-mask" wx:if="{{showAddModal}}" bindtap="hideModal">
    <view class="modal-container" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">{{editingLog ? 'ç¼–è¾‘ç—‡çŠ¶' : 'æ·»åŠ ç—‡çŠ¶'}}</text>
        <text class="modal-close" bindtap="hideModal">âœ•</text>
      </view>
      <view class="modal-content">
        <view class="form-item">
          <text class="form-label">æ—¥æœŸ</text>
          <picker mode="date" value="{{formData.entry_date}}" end="{{today}}" bindchange="onDateChange">
            <view class="picker-value">
              <text class="picker-icon">ğŸ“…</text>
              <text>{{formData.entry_date || 'è¯·é€‰æ‹©æ—¥æœŸ'}}</text>
            </view>
          </picker>
        </view>

        <view class="form-item">
          <text class="form-label">ç—‡çŠ¶åç§°</text>
          <input class="form-input"
                 placeholder="å¦‚ï¼šå¤´ç—›ã€å’³å—½ã€å¤±çœ ç­‰"
                 placeholder-class="input-placeholder"
                 value="{{formData.symptom}}"
                 bindinput="onSymptomInput" />
        </view>

        <view class="form-item">
          <text class="form-label">ä¸¥é‡ç¨‹åº¦</text>
          <picker mode="selector" range="{{severityOptions}}" range-key="label" bindchange="onSeverityChange">
            <view class="picker-value severity-picker">
              <view class="severity-dots">
                <view class="severity-dot" wx:for="{{5}}" wx:key="index" 
                      style="background: {{item < formData.severity ? severityOptions[formData.severity-1].color : '#e0e0e0'}}"></view>
              </view>
              <text>{{severityOptions[formData.severity-1].label}}</text>
            </view>
          </picker>
        </view>

        <view class="form-item">
          <text class="form-label">å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰</text>
          <textarea class="form-textarea"
                    placeholder="æè¿°ç—‡çŠ¶è¯¦æƒ…ã€æŒç»­æ—¶é—´ç­‰"
                    placeholder-class="input-placeholder"
                    value="{{formData.notes}}"
                    bindinput="onNotesInput"
                    maxlength="500"></textarea>
        </view>
      </view>
      <view class="modal-actions">
        <button class="modal-btn cancel-btn" bindtap="hideModal">å–æ¶ˆ</button>
        <button class="modal-btn confirm-btn" bindtap="submitForm" loading="{{submitting}}">
          {{editingLog ? 'ä¿å­˜' : 'æ·»åŠ '}}
        </button>
      </view>
    </view>
  </view>
</view>
