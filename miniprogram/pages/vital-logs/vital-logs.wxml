<view class="vital-logs-container app-theme">
  <view class="header-section">
    <text class="header-title">ä½“å¾æ—¥å¿—</text>
    <text class="header-desc">è®°å½•è¡€å‹ã€å¿ƒç‡ã€ä½“é‡ç­‰ä½“å¾æ•°æ®</text>
  </view>

  <view class="logs-list" wx:if="{{logs.length > 0}}">
    <view class="log-item" wx:for="{{logs}}" wx:key="id">
      <view class="log-header">
        <view class="vital-type-badge" style="background: {{item.vitalTypeInfo.color}}20">
          <text class="vital-icon">{{item.vitalTypeInfo.icon}}</text>
          <text class="vital-label" style="color: {{item.vitalTypeInfo.color}}">{{item.vitalTypeInfo.label}}</text>
        </view>
        <text class="log-date">{{item.entry_date}}</text>
      </view>
      <view class="log-content">
        <view class="value-display">
          <text class="value-number">{{item.value}}</text>
          <text class="value-unit" wx:if="{{item.unit}}">{{item.unit}}</text>
        </view>
        <view class="log-notes" wx:if="{{item.notes}}">
          <text>{{item.notes}}</text>
        </view>
        <view class="log-actions">
          <text class="action-btn edit" bindtap="editLog" data-log="{{item}}">ç¼–è¾‘</text>
          <text class="action-btn delete" bindtap="deleteLog" data-log="{{item}}">åˆ é™¤</text>
        </view>
      </view>
    </view>
  </view>

  <view class="empty-state" wx:elif="{{!loading}}">
    <text class="empty-icon">ğŸ“Š</text>
    <text class="empty-text">æš‚æ— ä½“å¾è®°å½•</text>
    <text class="empty-desc">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ æ‚¨çš„ä½“å¾æ•°æ®</text>
  </view>

  <view class="loading-state" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <button class="add-btn" bindtap="showAddModal">
    <text class="add-icon">â•</text>
    <text>æ·»åŠ ä½“å¾è®°å½•</text>
  </button>

  <view class="modal-mask" wx:if="{{showAddModal}}" bindtap="hideModal">
    <view class="modal-container" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">{{editingLog ? 'ç¼–è¾‘ä½“å¾' : 'æ·»åŠ ä½“å¾'}}</text>
        <text class="modal-close" bindtap="hideModal">âœ•</text>
      </view>
      <view class="modal-content">
        <view class="form-item">
          <text class="form-label">æ—¥æœŸ</text>
          <picker mode="date" value="{{formData.entry_date}}" end="{{today}}" bindchange="onDateChange">
            <view class="picker-value">
              <text class="picker-icon">ğŸ“…</text>
              <text>{{formData.entry_date || 'è¯·é€‰æ‹©æ—¥æœŸ'}}</text>
            </view>
          </picker>
        </view>

        <view class="form-item">
          <text class="form-label">ä½“å¾ç±»å‹</text>
          <picker mode="selector" range="{{vitalTypes}}" range-key="label" bindchange="onVitalTypeChange">
            <view class="picker-value">
              <text class="picker-icon">{{vitalTypes[0].icon}}</text>
              <text>{{vitalTypes[0].label}}</text>
            </view>
          </picker>
        </view>

        <view class="form-item">
          <text class="form-label">æ•°å€¼</text>
          <view class="value-input-row">
            <input class="form-input value-input"
                   placeholder="å¦‚ï¼š120/80"
                   placeholder-class="input-placeholder"
                   value="{{formData.value}}"
                   bindinput="onValueInput" />
            <input class="form-input unit-input"
                   placeholder="å•ä½"
                   placeholder-class="input-placeholder"
                   value="{{formData.unit}}"
                   bindinput="onUnitInput" />
          </view>
        </view>

        <view class="form-item">
          <text class="form-label">å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰</text>
          <textarea class="form-textarea"
                    placeholder="è®°å½•æµ‹é‡æ—¶é—´ã€çŠ¶æ€ç­‰"
                    placeholder-class="input-placeholder"
                    value="{{formData.notes}}"
                    bindinput="onNotesInput"
                    maxlength="500"></textarea>
        </view>
      </view>
      <view class="modal-actions">
        <button class="modal-btn cancel-btn" bindtap="hideModal">å–æ¶ˆ</button>
        <button class="modal-btn confirm-btn" bindtap="submitForm" loading="{{submitting}}">
          {{editingLog ? 'ä¿å­˜' : 'æ·»åŠ '}}
        </button>
      </view>
    </view>
  </view>
</view>
